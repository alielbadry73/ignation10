<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schedule Widget Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.7/dist/iconify-icon.min.css">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .schedule-widget {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .schedule-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        .schedule-view-toggles {
            display: flex;
            background: #f8fafc;
            border-radius: 12px;
            padding: 4px;
            gap: 4px;
        }
        .schedule-view-toggle {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .schedule-view-toggle.active {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }
        .schedule-today-btn {
            background: #e0f2fe;
            color: #0369a1;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .schedule-calendar {
            margin-bottom: 1rem;
        }
        .schedule-days-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 0.5rem;
        }
        .schedule-day-header {
            text-align: center;
            font-weight: 600;
            font-size: 0.8rem;
            color: #64748b;
            padding: 0.5rem 0;
        }
        .schedule-days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        .schedule-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-height: 40px;
        }
        .schedule-day:hover {
            background: #f1f5f9;
        }
        .schedule-day.other-month {
            color: #cbd5e1;
        }
        .schedule-day.today {
            background: #fef3c7;
            color: #92400e;
            font-weight: 600;
        }
        .schedule-day.has-session {
            background: #ddd6fe;
            color: #5b21b6;
            font-weight: 600;
        }
        .schedule-day.has-session::after {
            content: '';
            position: absolute;
            bottom: 4px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: #5b21b6;
            border-radius: 50%;
        }
        .schedule-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        .schedule-nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        .schedule-monitor-icon {
            width: 32px;
            height: 32px;
            background: #f1f5f9;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>Schedule Widget Test</h2>
        <div id="scheduleWidget">
            <!-- Schedule will be loaded here -->
        </div>
    </div>

    <script>
        function generateScheduleWidget() {
            console.log('generateScheduleWidget called (Test)');
            const widget = document.getElementById('scheduleWidget');
            console.log('Widget element (Test):', widget);
            if (!widget) {
                console.log('Widget not found! (Test)');
                return;
            }

            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            // Sample sessions data
            const sessions = [
                { date: 5, title: "Test Session 1", time: "10:00 AM", type: "lecture" },
                { date: 12, title: "Test Session 2", time: "2:00 PM", type: "workshop" },
                { date: 19, title: "Test Session 3", time: "11:00 AM", type: "lecture" },
                { date: 26, title: "Test Session 4", time: "3:00 PM", type: "tutorial" }
            ];

            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
            const today = currentDate.getDate();

            let calendarHTML = `
                <div class="schedule-widget">
                    <div class="schedule-header">
                        <div class="schedule-view-toggles">
                            <button class="schedule-view-toggle active" onclick="setScheduleView('month')">month</button>
                            <button class="schedule-view-toggle" onclick="setScheduleView('week')">week</button>
                            <button class="schedule-view-toggle" onclick="setScheduleView('day')">day</button>
                        </div>
                        <button class="schedule-today-btn" onclick="goToToday()">today</button>
                    </div>
                    
                    <div class="schedule-calendar">
                        <div class="schedule-days-header">
                            <div class="schedule-day-header">Sun</div>
                            <div class="schedule-day-header">Mon</div>
                            <div class="schedule-day-header">Tue</div>
                            <div class="schedule-day-header">Wed</div>
                            <div class="schedule-day-header">Thu</div>
                            <div class="schedule-day-header">Fri</div>
                            <div class="schedule-day-header">Sat</div>
                        </div>
                        
                        <div class="schedule-days-grid">
            `;

            // Previous month days
            const prevMonth = new Date(currentYear, currentMonth, 0);
            const daysInPrevMonth = prevMonth.getDate();
            for (let i = firstDayOfMonth - 1; i >= 0; i--) {
                calendarHTML += `<div class="schedule-day other-month">${daysInPrevMonth - i}</div>`;
            }

            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const hasSession = sessions.some(session => session.date === day);
                const isToday = day === today;
                let dayClass = '';
                
                if (isToday) dayClass = 'today';
                else if (hasSession) dayClass = 'has-session';
                
                calendarHTML += `<div class="schedule-day ${dayClass}" onclick="showSessionDetails(${day})">${day}</div>`;
            }

            // Next month days
            const remainingCells = 42 - (firstDayOfMonth + daysInMonth);
            for (let day = 1; day <= remainingCells; day++) {
                calendarHTML += `<div class="schedule-day other-month">${day}</div>`;
            }

            calendarHTML += `
                        </div>
                    </div>
                    
                    <div class="schedule-navigation">
                        <div class="schedule-monitor-icon">
                            <iconify-icon icon="material-symbols:monitor"></iconify-icon>
                        </div>
                        <button class="schedule-nav-btn" onclick="navigateSchedule(-1)">
                            <iconify-icon icon="material-symbols:chevron-left"></iconify-icon>
                            <iconify-icon icon="material-symbols:chevron-right"></iconify-icon>
                        </button>
                    </div>
                </div>
            `;

            console.log('Generated calendar HTML:', calendarHTML);
            widget.innerHTML = calendarHTML;
            console.log('Widget innerHTML set successfully (Test)');
        }

        function setScheduleView(view) {
            document.querySelectorAll('.schedule-view-toggle').forEach(toggle => {
                toggle.classList.remove('active');
            });
            event.target.classList.add('active');
            console.log(`Switched to ${view} view`);
        }

        function goToToday() {
            console.log('Go to today clicked');
        }

        function showSessionDetails(day) {
            alert(`Session on day ${day}`);
        }

        function navigateSchedule(direction) {
            console.log(`Navigate schedule: ${direction > 0 ? 'next' : 'previous'}`);
        }

        // Test the widget
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, generating schedule widget...');
            generateScheduleWidget();
        });
    </script>
</body>
</html>
