<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Daily Practice Card - IG Nation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <style>
        body { padding: 20px; background: #f8f9fa; }
        .debug-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: white; }
        .question-card { margin: 10px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #f8f9fa; }
        .success { color: #28a745; }
        .warning { color: #ffc107; }
        .error { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug Daily Practice Card Issues</h1>
        
        <!-- Test Actions -->
        <div class="debug-section">
            <h3>Test Actions</h3>
            <div class="d-grid gap-2">
                <button class="btn btn-primary" onclick="testCardRefresh()">üîÑ Test Card Refresh</button>
                <button class="btn btn-warning" onclick="addTestQuestion('english')">‚ûï Add Test English Question</button>
                <button class="btn btn-info" onclick="addTestQuestion('physics')">‚ûï Add Test Physics Question</button>
                <button class="btn btn-success" onclick="addTestQuestion('mathematics')">‚ûï Add Test Mathematics Question</button>
                <button class="btn btn-danger" onclick="clearAllQuestions()">üßπ Clear All Questions</button>
            </div>
        </div>
        
        <!-- Current Questions Status -->
        <div class="debug-section">
            <h3>Current Questions Status</h3>
            <div class="row">
                <div class="col-md-4">
                    <h5>English Questions</h5>
                    <p>Count: <span id="englishCount">0</span></p>
                    <div id="englishQuestions"></div>
                </div>
                <div class="col-md-4">
                    <h5>Physics Questions</h5>
                    <p>Count: <span id="physicsCount">0</span></p>
                    <div id="physicsQuestions"></div>
                </div>
                <div class="col-md-4">
                    <h5>Mathematics Questions</h5>
                    <p>Count: <span id="mathematicsCount">0</span></p>
                    <div id="mathematicsQuestions"></div>
                </div>
            </div>
        </div>
        
        <!-- Debug Results -->
        <div class="debug-section">
            <h3>Debug Results</h3>
            <div id="debugResults">Click "Test Card Refresh" to start debugging</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        function testCardRefresh() {
            const results = [];
            results.push('<h5>üîÑ Testing card refresh functionality...</h5>');
            
            // Test each subject
            const subjects = ['english', 'physics', 'mathematics'];
            
            subjects.forEach(subject => {
                const key = `${subject}_daily_practice_questions`;
                const questions = JSON.parse(localStorage.getItem(key) || '[]');
                
                results.push(`<h6>${subject.charAt(0).toUpperCase() + subject.slice(1)} Questions (${questions.length}):</h6>`);
                
                if (questions.length === 0) {
                    results.push(`<p class="warning">No questions found for ${subject}</p>`);
                } else {
                    questions.forEach((question, index) => {
                        results.push(`<div class="question-card">`);
                        results.push(`<p><strong>Question ${index + 1}:</strong></p>`);
                        results.push(`<ul>`);
                        results.push(`<li>ID: ${question.id || 'undefined'}</li>`);
                        results.push(`<li>Type: ${question.type || 'undefined'}</li>`);
                        results.push(`<li>Text: ${question.question || question.questionText || question.title || 'undefined'}</li>`);
                        results.push(`<li>Created: ${question.createdAt || 'undefined'}</li>`);
                        results.push(`<li>Subject: ${question.subject || 'undefined'}</li>`);
                        results.push(`<li>Points: ${question.points || 'undefined'}</li>`);
                        results.push(`<li>Difficulty: ${question.difficulty || 'undefined'}</li>`);
                        results.push(`<li>Topic: ${question.topic || 'undefined'}</li>`);
                        results.push(`</ul>`);
                        results.push(`</div>`);
                    });
                }
            });
            
            document.getElementById('debugResults').innerHTML = results.join('');
            updateQuestionCounts();
        }
        
        function addTestQuestion(subject) {
            const results = [];
            results.push(`<h5>‚ûï Adding test question for ${subject}...</h5>`);
            
            try {
                const key = `${subject}_daily_practice_questions`;
                const questions = JSON.parse(localStorage.getItem(key) || '[]');
                
                const testQuestion = {
                    id: Date.now().toString() + '_' + Math.random().toString(36).substr(2, 9),
                    type: 'short-answer',
                    question: `Test question for ${subject} - ${new Date().toLocaleString()}`,
                    questionText: `Test question for ${subject} - ${new Date().toLocaleString()}`,
                    title: `Test question for ${subject} - ${new Date().toLocaleString()}`,
                    points: 10,
                    timeLimit: null,
                    difficulty: 'medium',
                    topic: 'Test Topic',
                    bulletPoints: [],
                    options: [],
                    correctAnswer: 'Test answer',
                    expectedAnswer: 'Test answer',
                    fileUploadSettings: {
                        allowedTypes: ['jpg', 'png', 'pdf'],
                        maxSize: 5
                    },
                    createdAt: new Date().toISOString(),
                    subject: subject
                };
                
                questions.push(testQuestion);
                localStorage.setItem(key, JSON.stringify(questions));
                
                results.push(`<p class="success">‚úÖ Test question added to ${subject}</p>`);
                results.push(`<p>Question ID: ${testQuestion.id}</p>`);
                results.push(`<p>Total questions in ${subject}: ${questions.length}</p>`);
                
            } catch (error) {
                results.push(`<p class="error">‚ùå Error adding test question: ${error.message}</p>`);
            }
            
            document.getElementById('debugResults').innerHTML = results.join('');
            updateQuestionCounts();
            testCardRefresh();
        }
        
        function clearAllQuestions() {
            const results = [];
            results.push('<h5>üßπ Clearing all daily practice questions...</h5>');
            
            try {
                const subjects = ['english', 'physics', 'mathematics'];
                subjects.forEach(subject => {
                    const key = `${subject}_daily_practice_questions`;
                    localStorage.removeItem(key);
                    results.push(`<p class="success">‚úÖ Cleared ${subject} questions</p>`);
                });
                
                results.push('<p class="success">üéâ All questions cleared successfully!</p>');
                
            } catch (error) {
                results.push(`<p class="error">‚ùå Error clearing questions: ${error.message}</p>`);
            }
            
            document.getElementById('debugResults').innerHTML = results.join('');
            updateQuestionCounts();
        }
        
        function updateQuestionCounts() {
            const subjects = ['english', 'physics', 'mathematics'];
            subjects.forEach(subject => {
                const key = `${subject}_daily_practice_questions`;
                const questions = JSON.parse(localStorage.getItem(key) || '[]');
                document.getElementById(`${subject}Count`).textContent = questions.length;
                
                // Show recent questions
                const container = document.getElementById(`${subject}Questions`);
                if (questions.length === 0) {
                    container.innerHTML = '<p class="text-muted">No questions</p>';
                } else {
                    const recentQuestions = questions.slice(-3);
                    container.innerHTML = recentQuestions.map((question, index) => {
                        const questionText = question.question || question.questionText || question.title || 'No text';
                        return `<div class="small text-muted">${index + 1}. ${questionText.substring(0, 30)}...</div>`;
                    }).join('');
                }
            });
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateQuestionCounts();
        });
    </script>
</body>
</html>






