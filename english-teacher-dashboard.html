<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Teacher Dashboard - Professional Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.7/dist/iconify-icon.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;
            --dark-color: #1f2937;
            --light-color: #f8fafc;
            --border-color: #e5e7eb;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            color: var(--text-primary);
        }

        /* Header */
        .teacher-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 1.5rem 0;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .header-title h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
        }

        .header-title p {
            font-size: 0.9rem;
            opacity: 0.9;
            margin: 0;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .notification-btn {
            position: relative;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 0.75rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .notification-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-section:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .profile-avatar {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .profile-info h6 {
            margin: 0;
            font-weight: 600;
        }

        .profile-info small {
            opacity: 0.8;
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Dashboard Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-icon.primary { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); }
        .stat-icon.success { background: linear-gradient(135deg, var(--success-color), #059669); }
        .stat-icon.warning { background: linear-gradient(135deg, var(--warning-color), #d97706); }
        .stat-icon.danger { background: linear-gradient(135deg, var(--danger-color), #dc2626); }

        .stat-content h3 {
            font-size: 2rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-primary);
        }

        .stat-content p {
            color: var(--text-secondary);
            margin: 0.25rem 0 0 0;
            font-size: 0.9rem;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .trend-up { color: var(--success-color); }
        .trend-down { color: var(--danger-color); }

        /* Quick Actions */
        .quick-actions {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title iconify-icon {
            font-size: 1.8rem;
            color: var(--primary-color);
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            color: white;
        }

        .action-btn.success {
            background: linear-gradient(135deg, var(--success-color), #059669);
        }

        .action-btn.warning {
            background: linear-gradient(135deg, var(--warning-color), #d97706);
        }

        .action-btn.danger {
            background: linear-gradient(135deg, var(--danger-color), #dc2626);
        }

        .action-btn iconify-icon {
            font-size: 2rem;
        }

        .action-btn h6 {
            margin: 0;
            font-weight: 600;
            font-size: 1rem;
        }

        .action-btn p {
            margin: 0;
            font-size: 0.8rem;
            opacity: 0.9;
        }

        /* Tabs */
        .content-tabs {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .tab-nav {
            display: flex;
            background: var(--light-color);
            border-bottom: 1px solid var(--border-color);
        }

        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .tab-btn.active {
            background: white;
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
        }

        .tab-btn:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-color);
        }

        .tab-content {
            padding: 2rem;
            min-height: 500px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Assessment Cards */
        .assessments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .assessment-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
        }

        .assessment-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .assessment-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .assessment-type {
            background: var(--primary-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .assessment-type.quiz { background: var(--success-color); }
        .assessment-type.exam { background: var(--warning-color); }

        .assessment-menu {
            position: relative;
        }

        .menu-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .menu-btn:hover {
            background: var(--light-color);
            color: var(--text-primary);
        }

        .assessment-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .assessment-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .assessment-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .assessment-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* Grading Table */
        .grading-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .table {
            margin: 0;
        }

        .table thead th {
            background: var(--light-color);
            border: none;
            padding: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .table tbody td {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            vertical-align: middle;
        }

        .student-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .student-avatar {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .student-details h6 {
            margin: 0;
            font-weight: 600;
            color: var(--text-primary);
        }

        .student-details small {
            color: var(--text-secondary);
        }

        .grade-input {
            width: 80px;
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            text-align: center;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-graded {
            background: #d1fae5;
            color: #065f46;
        }

        .status-late {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Modal Styles */
        .modal-content {
            border-radius: 16px;
            border: none;
            box-shadow: var(--shadow-xl);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 16px 16px 0 0;
            padding: 1.5rem;
        }

        .modal-title {
            font-weight: 700;
            margin: 0;
        }

        .btn-close {
            filter: invert(1);
        }

        .form-label {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .form-control {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* Question Creator */
        .question-creator {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
        }

        .question-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .question-type-btn {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-type-btn:hover {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .question-type-btn.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }

        .question-type-btn iconify-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .question-type-btn h6 {
            margin: 0;
            font-weight: 600;
        }

        .question-type-btn p {
            margin: 0.25rem 0 0 0;
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                padding: 0 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .actions-grid {
                grid-template-columns: 1fr;
            }

            .tab-nav {
                flex-direction: column;
            }

            .assessments-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            margin-bottom: 0.5rem;
            min-width: 300px;
        }

        .toast-header {
            background: var(--light-color);
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 1rem;
            border-radius: 8px 8px 0 0;
        }

        .toast-body {
            padding: 1rem;
        }

        .toast.success .toast-header {
            background: #d1fae5;
            color: #065f46;
        }

        .toast.error .toast-header {
            background: #fee2e2;
            color: #991b1b;
        }

        .toast.warning .toast-header {
            background: #fef3c7;
            color: #92400e;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="teacher-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo-icon">
                    <iconify-icon icon="material-symbols:menu-book"></iconify-icon>
                </div>
                <div class="header-title">
                    <h1>English Teacher Dashboard</h1>
                    <p>Professional Assessment & Grading System</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="notification-btn" onclick="showNotifications()">
                    <iconify-icon icon="material-symbols:notifications"></iconify-icon>
                    <span class="notification-badge" id="notificationCount">3</span>
                </button>
                <div class="profile-section" onclick="showProfileMenu()">
                    <div class="profile-avatar">
                        <iconify-icon icon="material-symbols:person"></iconify-icon>
                    </div>
                    <div class="profile-info">
                        <h6>Ms. Emily Rodriguez</h6>
                        <small>English Teacher</small>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon primary">
                        <iconify-icon icon="material-symbols:assignment"></iconify-icon>
                    </div>
                    <div class="stat-trend trend-up">
                        <iconify-icon icon="material-symbols:trending-up"></iconify-icon>
                        +12%
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="totalAssignments">0</h3>
                    <p>Total Assignments</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon success">
                        <iconify-icon icon="material-symbols:quiz"></iconify-icon>
                    </div>
                    <div class="stat-trend trend-up">
                        <iconify-icon icon="material-symbols:trending-up"></iconify-icon>
                        +8%
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="totalQuizzes">0</h3>
                    <p>Active Quizzes</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon warning">
                        <iconify-icon icon="material-symbols:school"></iconify-icon>
                    </div>
                    <div class="stat-trend trend-down">
                        <iconify-icon icon="material-symbols:trending-down"></iconify-icon>
                        -3%
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="totalExams">0</h3>
                    <p>Upcoming Exams</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon danger">
                    <iconify-icon icon="material-symbols:grading"></iconify-icon>
                    </div>
                    <div class="stat-trend trend-up">
                        <iconify-icon icon="material-symbols:trending-up"></iconify-icon>
                        +15%
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="pendingGrading">0</h3>
                    <p>Pending Grading</p>
                </div>
            </div>
        </div>


        <!-- Quick Actions -->
        <div class="quick-actions">
            <h2 class="section-title">
                <iconify-icon icon="material-symbols:flash-on"></iconify-icon>
                Quick Actions
            </h2>
            <div class="actions-grid">
                <button class="action-btn" onclick="openCreateModal('assignment')">
                    <iconify-icon icon="material-symbols:add"></iconify-icon>
                    <h6>Create Assignment</h6>
                    <p>New English assignment</p>
                </button>
                <button class="action-btn success" onclick="openCreateModal('quiz')">
                    <iconify-icon icon="material-symbols:quiz"></iconify-icon>
                    <h6>Create Quiz</h6>
                    <p>Quick assessment</p>
                </button>
                <button class="action-btn warning" onclick="openCreateModal('exam')">
                    <iconify-icon icon="material-symbols:school"></iconify-icon>
                    <h6>Create Exam</h6>
                    <p>Formal examination</p>
                </button>
                <button class="action-btn danger" onclick="openGradingPanel()">
                    <iconify-icon icon="material-symbols:grading"></iconify-icon>
                    <h6>Grade Submissions</h6>
                    <p>Review & grade work</p>
                </button>
            </div>
        </div>

        <!-- Main Content Tabs -->
        <div class="content-tabs">
            <div class="tab-nav">
                <button class="tab-btn active" onclick="switchTab('assessments')">
                    <iconify-icon icon="material-symbols:folder"></iconify-icon>
                    My Assessments
                </button>
                <button class="tab-btn" onclick="switchTab('grading')">
                    <iconify-icon icon="material-symbols:grading"></iconify-icon>
                    Grading Center
                </button>
                <button class="tab-btn" onclick="switchTab('analytics')">
                    <iconify-icon icon="material-symbols:analytics"></iconify-icon>
                    Analytics
                </button>
                <button class="tab-btn" onclick="switchTab('students')">
                    <iconify-icon icon="material-symbols:groups"></iconify-icon>
                    Students
                </button>
            </div>

            <div class="tab-content">
                <!-- Assessments Tab -->
                <div id="assessments" class="tab-pane active">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3>My Assessments</h3>
                        <div class="d-flex gap-2">
                            <select class="form-control" style="width: auto;" onchange="filterAssessments(this.value)">
                                <option value="all">All Types</option>
                                <option value="assignment">Assignments</option>
                                <option value="quiz">Quizzes</option>
                                <option value="exam">Exams</option>
                            </select>
                            <button class="btn btn-primary" onclick="refreshAssessments()">
                                <iconify-icon icon="material-symbols:refresh"></iconify-icon>
                                Refresh
                            </button>
                        </div>
                    </div>
                    <div id="assessmentsContainer" class="assessments-grid">
                        <!-- Assessments will be loaded here -->
                    </div>
                </div>

                <!-- Grading Tab -->
                <div id="grading" class="tab-pane">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3>Grading Center</h3>
                        <div class="d-flex gap-2">
                            <select class="form-control" style="width: auto;" onchange="filterGrading(this.value)">
                                <option value="all">All Submissions</option>
                                <option value="pending">Pending</option>
                                <option value="graded">Graded</option>
                                <option value="late">Late</option>
                            </select>
                        </div>
                    </div>
                    <div id="gradingContainer">
                        <!-- Grading content will be loaded here -->
                    </div>
                </div>

                <!-- Analytics Tab -->
                <div id="analytics" class="tab-pane">
                    <h3>Analytics & Reports</h3>
                    <div class="loading">
                        <div class="spinner"></div>
                        Analytics dashboard coming soon...
                    </div>
                </div>

                <!-- Students Tab -->
                <div id="students" class="tab-pane">
                    <h3>Student Management</h3>
                    <div class="loading">
                        <div class="spinner"></div>
                        Student management coming soon...
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Create Assessment Modal -->
    <div class="modal fade" id="createModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="createModalTitle">Create Assessment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="createForm">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label class="form-label">Assessment Title</label>
                                    <input type="text" class="form-control" id="assessmentTitle" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" id="assessmentDescription" rows="3"></textarea>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">Total Points</label>
                                            <input type="number" class="form-control" id="totalPoints" min="1" value="100">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">Time Limit (minutes)</label>
                                            <input type="number" class="form-control" id="timeLimit" placeholder="Optional">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label class="form-label">Number of Questions</label>
                                            <div class="input-group">
                                                <input type="number" class="form-control" id="numberOfQuestions" min="1" max="50" value="5" placeholder="Auto-generate questions">
                                                <div class="input-group-text">
                                                    <input type="checkbox" class="form-check-input" id="autoGenerateQuestions" checked>
                                                    <label class="form-check-label ms-2" for="autoGenerateQuestions">Auto-generate</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Due Date</label>
                                            <input type="datetime-local" class="form-control" id="dueDate" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Difficulty</label>
                                            <select class="form-control" id="difficulty">
                                                <option value="easy">Easy</option>
                                                <option value="medium" selected>Medium</option>
                                                <option value="hard">Hard</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="question-creator">
                                    <h6 class="mb-3">Question Types</h6>
                                    <div class="question-types">
                                        <div class="question-type-btn active" data-type="multiple-choice" onclick="selectQuestionType('multiple-choice')">
                                            <iconify-icon icon="material-symbols:radio-button-checked"></iconify-icon>
                                            <h6>Multiple Choice</h6>
                                            <p>Single answer</p>
                                        </div>
                                        <div class="question-type-btn" data-type="multiple-select" onclick="selectQuestionType('multiple-select')">
                                            <iconify-icon icon="material-symbols:check-box"></iconify-icon>
                                            <h6>Multiple Select</h6>
                                            <p>Multiple answers</p>
                                        </div>
                                        <div class="question-type-btn" data-type="true-false" onclick="selectQuestionType('true-false')">
                                            <iconify-icon icon="material-symbols:toggle-on"></iconify-icon>
                                            <h6>True/False</h6>
                                            <p>Binary choice</p>
                                        </div>
                                        <div class="question-type-btn" data-type="short-answer" onclick="selectQuestionType('short-answer')">
                                            <iconify-icon icon="material-symbols:short-text"></iconify-icon>
                                            <h6>Short Answer</h6>
                                            <p>Text response</p>
                                        </div>
                                        <div class="question-type-btn" data-type="essay" onclick="selectQuestionType('essay')">
                                            <iconify-icon icon="material-symbols:article"></iconify-icon>
                                            <h6>Essay</h6>
                                            <p>Long form</p>
                                        </div>
                                        <div class="question-type-btn" data-type="file-upload" onclick="selectQuestionType('file-upload')">
                                            <iconify-icon icon="material-symbols:upload-file"></iconify-icon>
                                            <h6>File Upload</h6>
                                            <p>Document upload</p>
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button type="button" class="btn btn-primary flex-fill" onclick="addQuestion()">
                                            <iconify-icon icon="material-symbols:add"></iconify-icon>
                                            Add Question
                                        </button>
                                        <button type="button" class="btn btn-success flex-fill" onclick="generateQuestions()">
                                            <iconify-icon icon="material-symbols:auto-awesome"></iconify-icon>
                                            Generate
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="questionsContainer" class="mt-4">
                            <!-- Questions will be added here -->
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveAssessment()">
                        <iconify-icon icon="material-symbols:save"></iconify-icon>
                        Save Draft
                    </button>
                    <button type="button" class="btn btn-success" id="publishBtn">
                        <iconify-icon icon="material-symbols:publish"></iconify-icon>
                        Publish to Course
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Grading Modal -->
    <div class="modal fade" id="gradingModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="gradingModalTitle">Grade Submission</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="gradingModalBody">
                    <!-- Grading content will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success" onclick="saveGrade()">
                        <iconify-icon icon="material-symbols:save"></iconify-icon>
                        Save Grade
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global variables
        let currentAssessmentType = 'assignment';
        let currentQuestionType = 'multiple-choice';
        let questionCounter = 0;
        let assessments = [];
        let submissions = [];
        let englishQuizzes = [];
        let englishAssignments = [];
        let englishExams = [];

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadEnglishData();
            loadAssessments();
            updateStats();
            
            // Add event listener for publish button
            document.getElementById('publishBtn').addEventListener('click', function() {
                console.log('Publish button clicked via event listener!');
                publishAssessment();
            });
        });

        // Refresh data when page becomes visible (user navigates back)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                loadEnglishData();
                loadAssessments();
                updateStats();
            }
        });

        // Load English data from course pages - will be loaded from backend or localStorage
        function loadEnglishData() {
            // Load English assignments from localStorage
            const assignmentsData = localStorage.getItem('englishAssignments');
            englishAssignments = assignmentsData ? JSON.parse(assignmentsData) : [];
            
            // Load English quizzes from localStorage
            const quizzesData = localStorage.getItem('englishQuizzes');
            englishQuizzes = quizzesData ? JSON.parse(quizzesData) : [];
            
            // Load English exams from localStorage
            const examsData = localStorage.getItem('englishExams');
            englishExams = examsData ? JSON.parse(examsData) : [];
            
            console.log('Loaded English data:', {
                assignments: englishAssignments.length,
                quizzes: englishQuizzes.length,
                exams: englishExams.length
            });
        }

        // Tab switching
        function switchTab(tabName) {
            // Remove active class from all tabs and panes
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            
            // Add active class to selected tab and pane
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // Load content based on tab
            if (tabName === 'grading') {
                loadGradingContent();
            }
        }

        // Open create modal
        function openCreateModal(type) {
            currentAssessmentType = type;
            const modal = new bootstrap.Modal(document.getElementById('createModal'));
            const title = document.getElementById('createModalTitle');
            
            switch(type) {
                case 'assignment':
                    title.textContent = 'Create English Assignment';
                    break;
                case 'quiz':
                    title.textContent = 'Create English Quiz';
                    break;
                case 'exam':
                    title.textContent = 'Create English Exam';
                    break;
            }
            
            // Reset form
            document.getElementById('createForm').reset();
            document.getElementById('questionsContainer').innerHTML = '';
            questionCounter = 0;
            
            modal.show();
        }

        // Question type selection
        function selectQuestionType(type) {
            currentQuestionType = type;
            document.querySelectorAll('.question-type-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.question-type-btn').classList.add('active');
        }

        // Add question
        function addQuestion() {
            questionCounter++;
            const container = document.getElementById('questionsContainer');
            
            const questionHtml = `
                <div class="question-item mb-4 p-3 border rounded" id="question-${questionCounter}">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6>Question ${questionCounter}</h6>
                        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeQuestion(${questionCounter})">
                            <iconify-icon icon="material-symbols:delete"></iconify-icon>
                        </button>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Question Text</label>
                        <textarea class="form-control" name="questionText" rows="3" placeholder="Enter your question..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Points</label>
                        <input type="number" class="form-control" name="questionPoints" min="1" value="10">
                    </div>
                    <div id="questionOptions-${questionCounter}">
                        ${generateQuestionOptions(currentQuestionType, questionCounter)}
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', questionHtml);
        }

        // Generate question options based on type
        function generateQuestionOptions(type, questionId, options = []) {
            switch(type) {
                case 'multiple-choice':
                case 'multiple-select':
                    const optionHtml = options.length > 0 ? 
                        options.map((option, index) => `
                            <div class="input-group mb-2">
                                <input type="text" class="form-control" placeholder="Option ${index + 1}" value="${option}">
                                <div class="input-group-text">
                                    <input type="radio" name="correct-${questionId}" value="${index}">
                                </div>
                            </div>
                        `).join('') :
                        `
                            <div class="input-group mb-2">
                                <input type="text" class="form-control" placeholder="Option 1">
                                <div class="input-group-text">
                                    <input type="radio" name="correct-${questionId}" value="0">
                                </div>
                            </div>
                            <div class="input-group mb-2">
                                <input type="text" class="form-control" placeholder="Option 2">
                                <div class="input-group-text">
                                    <input type="radio" name="correct-${questionId}" value="1">
                                </div>
                            </div>
                        `;
                    
                    return `
                        <div class="mb-3">
                            <label class="form-label">Options</label>
                            <div id="options-${questionId}">
                                ${optionHtml}
                            </div>
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="addOption(${questionId})">
                                <iconify-icon icon="material-symbols:add"></iconify-icon>
                                Add Option
                            </button>
                        </div>
                    `;
                case 'true-false':
                    return `
                        <div class="mb-3">
                            <label class="form-label">Correct Answer</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="correct-${questionId}" value="true">
                                <label class="form-check-label">True</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="correct-${questionId}" value="false">
                                <label class="form-check-label">False</label>
                            </div>
                        </div>
                    `;
                case 'short-answer':
                case 'essay':
                    return `
                        <div class="mb-3">
                            <label class="form-label">Sample Answer (Optional)</label>
                            <textarea class="form-control" name="sampleAnswer" rows="2" placeholder="Provide a sample answer for reference..."></textarea>
                        </div>
                    `;
                case 'file-upload':
                    return `
                        <div class="mb-3">
                            <label class="form-label">Allowed File Types</label>
                            <select class="form-control" name="allowedTypes" multiple>
                                <option value="pdf" selected>PDF</option>
                                <option value="doc" selected>DOC</option>
                                <option value="docx" selected>DOCX</option>
                                <option value="jpg" selected>JPG</option>
                                <option value="png" selected>PNG</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Max File Size (MB)</label>
                            <input type="number" class="form-control" name="maxFileSize" value="10" min="1">
                        </div>
                    `;
                default:
                    return '';
            }
        }

        // Add option to multiple choice questions
        function addOption(questionId) {
            const container = document.getElementById(`options-${questionId}`);
            const optionCount = container.children.length;
            
            const optionHtml = `
                <div class="input-group mb-2">
                    <input type="text" class="form-control" placeholder="Option ${optionCount + 1}">
                    <div class="input-group-text">
                        <input type="radio" name="correct-${questionId}" value="${optionCount}">
                    </div>
                    <button type="button" class="btn btn-outline-danger" onclick="removeOption(this)">
                        <iconify-icon icon="material-symbols:close"></iconify-icon>
                    </button>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', optionHtml);
        }

        // Remove option
        function removeOption(button) {
            button.closest('.input-group').remove();
        }

        // Generate questions automatically
        function generateQuestions() {
            const numberOfQuestions = parseInt(document.getElementById('numberOfQuestions').value) || 5;
            const autoGenerate = document.getElementById('autoGenerateQuestions').checked;
            
            if (!autoGenerate) {
                showToast('Please enable auto-generation checkbox first!', 'warning');
                return;
            }
            
            // Clear existing questions
            document.getElementById('questionsContainer').innerHTML = '';
            questionCounter = 0;
            
            // Generate questions based on assessment type and subject
            const assessmentType = currentAssessmentType;
            const subject = 'english';
            
            for (let i = 1; i <= numberOfQuestions; i++) {
                questionCounter++;
                const container = document.getElementById('questionsContainer');
                
                // Generate question content based on type and subject
                const questionContent = generateQuestionContent(assessmentType, subject, i);
                
                const questionHtml = `
                    <div class="question-item mb-4 p-3 border rounded" id="question-${questionCounter}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6>Question ${questionCounter}</h6>
                            <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeQuestion(${questionCounter})">
                                <iconify-icon icon="material-symbols:delete"></iconify-icon>
                            </button>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Question Text</label>
                            <textarea class="form-control" name="questionText" rows="3" placeholder="Enter your question...">${questionContent.text}</textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Points</label>
                            <input type="number" class="form-control" name="questionPoints" min="1" value="${questionContent.points}">
                        </div>
                        <div id="questionOptions-${questionCounter}">
                            ${generateQuestionOptions(questionContent.type, questionCounter, questionContent.options)}
                        </div>
                    </div>
                `;
                
                container.insertAdjacentHTML('beforeend', questionHtml);
            }
            
            showToast(`Generated ${numberOfQuestions} questions automatically!`, 'success');
        }
        
        // Generate question content based on assessment type and subject
        function generateQuestionContent(assessmentType, subject, questionNumber) {
            const questionTemplates = {
                english: {
                    assignment: [
                        {
                            text: "Write a 200-word essay on the importance of education in modern society.",
                            type: "short-answer",
                            points: 15,
                            options: []
                        },
                        {
                            text: "Which of the following is a compound sentence?",
                            type: "multiple-choice",
                            points: 8,
                            options: ["The cat sat on the mat.", "The cat sat on the mat, and the dog slept nearby.", "Cats are independent animals.", "The mat was soft."]
                        },
                        {
                            text: "Identify the main theme in Shakespeare's 'Romeo and Juliet'.",
                            type: "short-answer",
                            points: 12,
                            options: []
                        },
                        {
                            text: "What is the correct plural form of 'child'?",
                            type: "multiple-choice",
                            points: 5,
                            options: ["childs", "children", "childes", "childrens"]
                        },
                        {
                            text: "A metaphor directly compares two things using 'like' or 'as'.",
                            type: "true-false",
                            points: 6,
                            options: []
                        }
                    ],
                    quiz: [
                        {
                            text: "What is the past tense of 'go'?",
                            type: "multiple-choice",
                            points: 4,
                            options: ["goed", "went", "gone", "going"]
                        },
                        {
                            text: "A noun is a word that describes an action.",
                            type: "true-false",
                            points: 3,
                            options: []
                        },
                        {
                            text: "Write a sentence using the word 'serendipity' correctly.",
                            type: "short-answer",
                            points: 8,
                            options: []
                        },
                        {
                            text: "Which literary device is used in 'The stars danced playfully in the moonlit sky'?",
                            type: "multiple-choice",
                            points: 6,
                            options: ["Simile", "Metaphor", "Personification", "Alliteration"]
                        },
                        {
                            text: "The word 'beautiful' is an adjective.",
                            type: "true-false",
                            points: 4,
                            options: []
                        }
                    ],
                    exam: [
                        {
                            text: "Analyze the use of symbolism in George Orwell's 'Animal Farm' and explain how it contributes to the overall theme of the novel.",
                            type: "short-answer",
                            points: 20,
                            options: []
                        },
                        {
                            text: "Compare and contrast the writing styles of Ernest Hemingway and F. Scott Fitzgerald, providing specific examples from their works.",
                            type: "short-answer",
                            points: 25,
                            options: []
                        },
                        {
                            text: "Write a critical analysis of the following poem, focusing on its themes, literary devices, and overall message.",
                            type: "short-answer",
                            points: 30,
                            options: []
                        },
                        {
                            text: "Which of the following best describes the purpose of a thesis statement in an essay?",
                            type: "multiple-choice",
                            points: 10,
                            options: ["To provide background information", "To state the main argument", "To list supporting evidence", "To conclude the essay"]
                        },
                        {
                            text: "The Oxford comma is always required in academic writing.",
                            type: "true-false",
                            points: 8,
                            options: []
                        }
                    ]
                }
            };
            
            const subjectTemplates = questionTemplates[subject] || questionTemplates.english;
            const typeTemplates = subjectTemplates[assessmentType] || subjectTemplates.assignment;
            
            // Cycle through templates or generate random content
            const templateIndex = (questionNumber - 1) % typeTemplates.length;
            return typeTemplates[templateIndex];
        }

        // Remove question
        function removeQuestion(questionId) {
            document.getElementById(`question-${questionId}`).remove();
        }

        // Save assessment
        function saveAssessment() {
            const formData = {
                id: Date.now().toString(),
                type: currentAssessmentType,
                title: document.getElementById('assessmentTitle').value,
                description: document.getElementById('assessmentDescription').value,
                totalPoints: parseInt(document.getElementById('totalPoints').value),
                timeLimit: document.getElementById('timeLimit').value ? parseInt(document.getElementById('timeLimit').value) : null,
                dueDate: document.getElementById('dueDate').value,
                difficulty: document.getElementById('difficulty').value,
                questions: collectQuestions(),
                createdAt: new Date().toISOString(),
                status: 'draft'
            };

            assessments.push(formData);
            saveToLocalStorage();
            loadAssessments();
            updateStats();
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('createModal'));
            modal.hide();
            
            showToast('Assessment saved as draft!', 'success');
        }

        // Publish assessment to course page
        function publishAssessment() {
            const formData = {
                id: Date.now().toString(),
                type: currentAssessmentType,
                title: document.getElementById('assessmentTitle').value,
                description: document.getElementById('assessmentDescription').value,
                totalPoints: parseInt(document.getElementById('totalPoints').value),
                timeLimit: document.getElementById('timeLimit').value ? parseInt(document.getElementById('timeLimit').value) : null,
                dueDate: document.getElementById('dueDate').value,
                difficulty: document.getElementById('difficulty').value,
                questions: collectQuestions(),
                status: 'published',
                createdAt: new Date().toISOString(),
                subject: 'english'
            };

            // Save to assessments (for teacher dashboard)
            assessments.push(formData);
            saveToLocalStorage();

            // Publish to course page based on type
            publishToCoursePage(formData);

            loadAssessments();
            updateStats();
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('createModal'));
            modal.hide();
            
            showToast('Assessment published to course page!', 'success');
        }

        // Publish assessment to the appropriate course page
        function publishToCoursePage(assessment) {
            const courseData = {
                id: assessment.id,
                title: assessment.title,
                description: assessment.description,
                points: assessment.totalPoints,
                dueDate: assessment.dueDate,
                difficulty: assessment.difficulty.charAt(0).toUpperCase() + assessment.difficulty.slice(1),
                estimatedTime: assessment.timeLimit ? `${assessment.timeLimit} minutes` : 'No time limit',
                questions: assessment.questions,
                status: 'pending',
                type: assessment.type, // Add the type field
                subject: 'english', // Add the subject field for fallback compatibility
                createdAt: new Date().toISOString()
            };

            // Determine the localStorage key based on assessment type
            let storageKey;
            switch(assessment.type) {
                case 'assignment':
                    storageKey = 'englishAssignments';
                    break;
                case 'quiz':
                    storageKey = 'englishQuizzes';
                    break;
                case 'exam':
                    storageKey = 'englishExams';
                    break;
                default:
                    console.error('Unknown assessment type:', assessment.type);
                    return;
            }

            // Load existing data and add new assessment
            const existingData = JSON.parse(localStorage.getItem(storageKey)) || [];
            existingData.push(courseData);
            localStorage.setItem(storageKey, JSON.stringify(existingData));

            console.log(`Published ${assessment.type} to ${storageKey}:`, courseData);
        }

        // Collect questions from form
        function collectQuestions() {
            const questions = [];
            const questionElements = document.querySelectorAll('.question-item');
            
            questionElements.forEach((element, index) => {
                const questionData = {
                    id: `q${index + 1}`,
                    type: currentQuestionType,
                    text: element.querySelector('[name="questionText"]').value,
                    points: parseInt(element.querySelector('[name="questionPoints"]').value),
                    options: [],
                    correctAnswer: null,
                    sampleAnswer: element.querySelector('[name="sampleAnswer"]')?.value || null
                };

                // Collect options for multiple choice questions
                if (currentQuestionType === 'multiple-choice' || currentQuestionType === 'multiple-select') {
                    const optionInputs = element.querySelectorAll('.input-group input[type="text"]');
                    optionInputs.forEach((input, optionIndex) => {
                        if (input.value.trim()) {
                            questionData.options.push(input.value.trim());
                        }
                    });
                    
                    // Find correct answer
                    const correctRadio = element.querySelector('input[type="radio"]:checked');
                    if (correctRadio) {
                        questionData.correctAnswer = parseInt(correctRadio.value);
                    }
                } else if (currentQuestionType === 'true-false') {
                    const correctRadio = element.querySelector('input[type="radio"]:checked');
                    if (correctRadio) {
                        questionData.correctAnswer = correctRadio.value;
                    }
                }

                questions.push(questionData);
            });

            return questions;
        }

        // Load assessments
        function loadAssessments() {
            const container = document.getElementById('assessmentsContainer');
            
            // Combine all English assessments
            const allAssessments = [
                ...englishAssignments.map(a => ({...a, type: 'assignment'})),
                ...englishQuizzes.map(q => ({...q, type: 'quiz'})),
                ...englishExams.map(e => ({...e, type: 'exam'}))
            ];
            
            if (allAssessments.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <iconify-icon icon="material-symbols:folder-open" style="font-size: 4rem; color: #ccc;"></iconify-icon>
                        <h4 class="mt-3 text-muted">No assessments yet</h4>
                        <p class="text-muted">Create your first assessment to get started</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = allAssessments.map(assessment => `
                <div class="assessment-card">
                    <div class="assessment-header">
                        <span class="assessment-type ${assessment.type}">${assessment.type.charAt(0).toUpperCase() + assessment.type.slice(1)}</span>
                        <div class="assessment-menu">
                            <button class="menu-btn" onclick="showAssessmentMenu('${assessment.id}')">
                                <iconify-icon icon="material-symbols:more-vert"></iconify-icon>
                            </button>
                        </div>
                    </div>
                    <div class="assessment-title">${assessment.title}</div>
                    <div class="assessment-meta">
                        <div class="meta-item">
                            <iconify-icon icon="material-symbols:schedule"></iconify-icon>
                            <span>${assessment.dueDate ? new Date(assessment.dueDate).toLocaleDateString() : 
                                   assessment.date ? new Date(assessment.date).toLocaleDateString() : 'No date'}</span>
                        </div>
                        <div class="meta-item">
                            <iconify-icon icon="material-symbols:star"></iconify-icon>
                            <span>${assessment.difficulty}</span>
                        </div>
                        <div class="meta-item">
                            <iconify-icon icon="material-symbols:quiz"></iconify-icon>
                            <span>${assessment.questions ? assessment.questions.length : 0} questions</span>
                        </div>
                    </div>
                    <div class="assessment-stats">
                        <div class="stat-item">
                            <div class="stat-value">${assessment.points || assessment.maxScore || 0}</div>
                            <div class="stat-label">Points</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${getSubmissionCount(assessment.id)}</div>
                            <div class="stat-label">Submissions</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${assessment.status}</div>
                            <div class="stat-label">Status</div>
                        </div>
                    </div>
                    <div class="assessment-actions">
                        <button class="btn-sm btn-primary" onclick="editAssessment('${assessment.id}')">
                            <iconify-icon icon="material-symbols:edit"></iconify-icon>
                            Edit
                        </button>
                        <button class="btn-sm btn-outline" onclick="viewSubmissions('${assessment.id}')">
                            <iconify-icon icon="material-symbols:visibility"></iconify-icon>
                            View
                        </button>
                        <a href="${getEnglishPageUrl(assessment.type)}" class="btn-sm btn-success">
                            <iconify-icon icon="material-symbols:open-in-new"></iconify-icon>
                            Open in Course
                        </a>
                    </div>
                </div>
            `).join('');
        }

        // Load grading content
        function loadGradingContent() {
            const container = document.getElementById('gradingContainer');
            const stored = localStorage.getItem('englishSubmissions');
            submissions = stored ? JSON.parse(stored) : getSampleSubmissions();
            
            if (submissions.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-5">
                        <iconify-icon icon="material-symbols:grading" style="font-size: 4rem; color: #ccc;"></iconify-icon>
                        <h4 class="mt-3 text-muted">No submissions to grade</h4>
                        <p class="text-muted">Student submissions will appear here when they submit their work</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="grading-table">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Student</th>
                                <th>Assessment</th>
                                <th>Submitted</th>
                                <th>Status</th>
                                <th>Grade</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${submissions.map(submission => `
                                <tr>
                                    <td>
                                        <div class="student-info">
                                            <div class="student-avatar">
                                                ${submission.student.name.charAt(0)}
                                            </div>
                                            <div class="student-details">
                                                <h6>${submission.student.name}</h6>
                                                <small>${submission.student.email}</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>${submission.assessmentTitle}</td>
                                    <td>${new Date(submission.submittedAt).toLocaleDateString()}</td>
                                    <td>
                                        <span class="status-badge status-${submission.status}">
                                            ${submission.status}
                                        </span>
                                    </td>
                                    <td>
                                        ${submission.grade ? `${submission.grade}/${submission.maxGrade}` : '-'}
                                    </td>
                                    <td>
                                        <button class="btn-sm btn-primary" onclick="gradeSubmission('${submission.id}')">
                                            <iconify-icon icon="material-symbols:grading"></iconify-icon>
                                            Grade
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Grade submission
        function gradeSubmission(submissionId) {
            const submission = submissions.find(s => s.id === submissionId);
            if (!submission) return;

            const modal = new bootstrap.Modal(document.getElementById('gradingModal'));
            document.getElementById('gradingModalTitle').textContent = `Grade: ${submission.assessmentTitle}`;
            
            document.getElementById('gradingModalBody').innerHTML = `
                <div class="row">
                    <div class="col-md-8">
                        <h6>Student: ${submission.student.name}</h6>
                        <h6>Assessment: ${submission.assessmentTitle}</h6>
                        <div class="mt-3">
                            <h6>Student's Answers:</h6>
                            <div class="border rounded p-3" style="background: #f8f9fa;">
                                ${submission.answers.map((answer, index) => `
                                    <div class="mb-3">
                                        <strong>Question ${index + 1}:</strong>
                                        <p class="mt-1">${answer}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h6>Grading</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Total Grade</label>
                                    <input type="number" class="form-control" id="totalGrade" max="${submission.maxGrade}" min="0" value="${submission.grade || 0}">
                                    <small class="text-muted">Out of ${submission.maxGrade} points</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Comments</label>
                                    <textarea class="form-control" id="gradeComments" rows="4" placeholder="Add feedback for the student...">${submission.comments || ''}</textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Status</label>
                                    <select class="form-control" id="gradeStatus">
                                        <option value="graded" ${submission.status === 'graded' ? 'selected' : ''}>Graded</option>
                                        <option value="pending" ${submission.status === 'pending' ? 'selected' : ''}>Pending</option>
                                        <option value="late" ${submission.status === 'late' ? 'selected' : ''}>Late</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.show();
        }

        // Save grade
        function saveGrade() {
            const submissionId = document.querySelector('[data-submission-id]')?.dataset.submissionId;
            if (!submissionId) return;

            const submission = submissions.find(s => s.id === submissionId);
            if (!submission) return;

            submission.grade = parseInt(document.getElementById('totalGrade').value);
            submission.comments = document.getElementById('gradeComments').value;
            submission.status = document.getElementById('gradeStatus').value;
            submission.gradedAt = new Date().toISOString();

            saveToLocalStorage();
            loadGradingContent();
            updateStats();
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('gradingModal'));
            modal.hide();
            
            showToast('Grade saved successfully!', 'success');
        }

        // Publish assessment
        function publishAssessment(assessmentId) {
            const assessment = assessments.find(a => a.id === assessmentId);
            if (!assessment) return;

            assessment.status = 'published';
            assessment.publishedAt = new Date().toISOString();
            
            saveToLocalStorage();
            loadAssessments();
            updateStats();
            
            showToast('Assessment published successfully!', 'success');
        }

        // View submissions
        function viewSubmissions(assessmentId) {
            const assessment = assessments.find(a => a.id === assessmentId);
            if (!assessment) return;

            const assessmentSubmissions = submissions.filter(s => s.assessmentId === assessmentId);
            
            // Switch to grading tab and filter
            switchTab('grading');
            // Filter grading content to show only this assessment's submissions
        }

        // Edit assessment
        function editAssessment(assessmentId) {
            const assessment = assessments.find(a => a.id === assessmentId);
            if (!assessment) return;

            // Open create modal with assessment data
            openCreateModal(assessment.type);
            
            // Populate form with existing data
            document.getElementById('assessmentTitle').value = assessment.title;
            document.getElementById('assessmentDescription').value = assessment.description;
            document.getElementById('totalPoints').value = assessment.totalPoints;
            document.getElementById('timeLimit').value = assessment.timeLimit || '';
            document.getElementById('dueDate').value = assessment.dueDate;
            document.getElementById('difficulty').value = assessment.difficulty;
            
            // Add existing questions
            assessment.questions.forEach(question => {
                addQuestion();
                // Populate question data
            });
        }

        // Get submission count
        function getSubmissionCount(assessmentId) {
            return submissions.filter(s => s.assessmentId === assessmentId).length;
        }

        // Update stats
        function updateStats() {
            // Use real data from English course pages
            document.getElementById('totalAssignments').textContent = englishAssignments.length;
            document.getElementById('totalQuizzes').textContent = englishQuizzes.length;
            document.getElementById('totalExams').textContent = englishExams.length;
            
            // Calculate pending grading from assignments and submissions
            const pendingAssignments = englishAssignments.filter(a => a.status === 'pending' || a.status === 'overdue').length;
            const pendingSubmissions = submissions.filter(s => s.status === 'pending').length;
            document.getElementById('pendingGrading').textContent = pendingAssignments + pendingSubmissions;

            // Update notification count with actual pending items
            const notificationCount = pendingAssignments + pendingSubmissions;
            document.getElementById('notificationCount').textContent = notificationCount;

        }

        // Filter assessments
        function filterAssessments(type) {
            // Implementation for filtering assessments by type
            loadAssessments();
        }

        // Filter grading
        function filterGrading(status) {
            // Implementation for filtering submissions by status
            loadGradingContent();
        }

        // Refresh assessments
        function refreshAssessments() {
            loadAssessments();
            showToast('Assessments refreshed', 'success');
        }

        // Open grading panel
        function openGradingPanel() {
            switchTab('grading');
        }

        // Show notifications
        function showNotifications() {
            showToast('You have 3 pending submissions to grade', 'warning');
        }

        // Show profile menu
        function showProfileMenu() {
            showToast('Profile menu coming soon', 'info');
        }

        // Save to localStorage
        function saveToLocalStorage() {
            localStorage.setItem('englishAssessments', JSON.stringify(assessments));
            localStorage.setItem('englishSubmissions', JSON.stringify(submissions));
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-header">
                    <iconify-icon icon="material-symbols:${type === 'success' ? 'check-circle' : type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'info'}"></iconify-icon>
                    <strong class="ms-2">${type.charAt(0).toUpperCase() + type.slice(1)}</strong>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        // Show assessment menu
        function showAssessmentMenu(assessmentId) {
            showToast('Assessment menu coming soon', 'info');
        }

        // Get English page URL based on assessment type
        function getEnglishPageUrl(type) {
            switch(type) {
                case 'assignment':
                    return 'english-assignments.html';
                case 'quiz':
                    return 'english-quizzes.html';
                case 'exam':
                    return 'english-exams.html';
                default:
                    return 'english-dashboard.html';
            }
        }

        // Sample data
        function getSampleAssessments() {
            return [];
        }

        function getSampleSubmissions() {
            return [
                {
                    id: '1',
                    assessmentId: '1',
                    assessmentTitle: 'Essay Writing Practice',
                    student: { name: 'John Smith', email: 'john@example.com' },
                    answers: ['The main argument is that technology improves education...', 'Evidence includes studies showing increased engagement...'],
                    submittedAt: '2024-01-14T15:30:00Z',
                    status: 'pending',
                    grade: null,
                    maxGrade: 100,
                    comments: ''
                },
                {
                    id: '2',
                    assessmentId: '2',
                    assessmentTitle: 'Poetry Analysis Quiz',
                    student: { name: 'Sarah Johnson', email: 'sarah@example.com' },
                    answers: ['The poem uses metaphor to convey...', 'The theme is about nature and time...'],
                    submittedAt: '2024-01-09T16:45:00Z',
                    status: 'graded',
                    grade: 50,
                    maxGrade: 50,
                    comments: 'Excellent analysis!'
                }
            ];
        }
    </script>
</body>
</html>
